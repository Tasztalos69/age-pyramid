(this["webpackJsonpage-pyramid"]=this["webpackJsonpage-pyramid"]||[]).push([[0],{24:function(e,t,a){e.exports=a(48)},30:function(e,t,a){},48:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(21),s=a.n(o),l=a(8),c=a.n(l),i=a(11),u=a(2),d=a(4),m=a(22),p=a(6),y=a(5),h=a(7),f=(a(30),a(9)),b=a.n(f),g=a(1),E=a(23);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function w(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var T=n.a.createElement("animate",{attributeName:"stroke-dashoffset",repeatCount:"indefinite",dur:"1.1627906976744184s",keyTimes:"0;1",values:"0;256.58892822265625"}),S=function(e){var t=e.svgRef,a=e.title,r=w(e,["svgRef","title"]);return n.a.createElement("svg",v({style:{background:"none",display:"block",shapeRendering:"auto"},width:"200px",height:"200px",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",ref:t},r),a?n.a.createElement("title",null,a):null,n.a.createElement("path",{fill:"none",stroke:"#5aa300",strokeWidth:8,strokeDasharray:"187.30991760253906 69.27901062011719",d:"M24.3 30C11.4 30 5 43.3 5 50s6.4 20 19.3 20c19.3 0 32.1-40 51.4-40 C88.6 30 95 43.3 95 50s-6.4 20-19.3 20C56.4 70 43.6 30 24.3 30z",strokeLinecap:"round",style:{transform:"scale(0.66)",transformOrigin:"50px 50px"}},T))},x=n.a.forwardRef((function(e,t){return n.a.createElement(S,v({svgRef:t},e))}));a.p;function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var k=n.a.createElement("path",{d:"M89.243,80.511l-27.16-22.102c2.969-4.504,4.704-9.891,4.704-15.678c0-15.753-12.815-28.568-28.568-28.568  S9.65,26.978,9.65,42.73s12.816,28.568,28.568,28.568c7.811,0,14.896-3.153,20.059-8.251l27.179,22.117  c0.557,0.452,1.226,0.673,1.892,0.673c0.872,0,1.736-0.378,2.329-1.106C90.722,83.446,90.528,81.557,89.243,80.511z M38.219,65.299  c-12.444,0-22.568-10.124-22.568-22.568s10.124-22.568,22.568-22.568c12.444,0,22.568,10.124,22.568,22.568  S50.663,65.299,38.219,65.299z"}),O=function(e){var t=e.svgRef,a=e.title,r=C(e,["svgRef","title"]);return n.a.createElement("svg",Y({x:"0px",y:"0px",viewBox:"0 0 100 125",enableBackground:"new 0 0 100 100",xmlSpace:"preserve",ref:t},r),a?n.a.createElement("title",null,a):null,k)},_=n.a.forwardRef((function(e,t){return n.a.createElement(O,Y({svgRef:t},e))})),P=(a.p,function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(y.a)(t).call(this,e))).searchCountry=function(e){if(document.querySelector(".cnt-list").style.opacity=1,a.setState({countryInput:e.target.value}),null===e.target.value||""===e.target.value||void 0===e.target.value)a.setState({matchedCountries:[]});else{var t=new RegExp("^".concat(e.target.value),"gi"),r=a.state.countries.filter((function(e){return e.name.match(t)}));a.setState({matchedCountries:r})}},a.handleYearChange=function(e){a.setState(Object(u.a)({},e.target.name,e.target.value))},a.state={countries:[],years:[{name:""}],countryInput:"",matchedCountries:[],selectedCountryId:null,selectedCountry:null,yearStart:"",yearEnd:"",modalDb:!1,modalTech:!1},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(c.a.mark((function e(){var t,a,r,n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Accept:"text/json"}},"https://cors-anywhere.herokuapp.com/https://data.un.org/ws/rest/data/DF_UNData_WPP/SP_POP_TOTL.A.Y_LT5.F._T..M?startPeriod=1995&endPeriod=1995",a="https://cors-anywhere.herokuapp.com/https://data.un.org/ws/rest/data/DF_UNData_WPP/SP_POP_TOTL.A.Y_LT5.F._T.001.M",e.next=4,b.a.get("https://cors-anywhere.herokuapp.com/https://data.un.org/ws/rest/data/DF_UNData_WPP/SP_POP_TOTL.A.Y_LT5.F._T..M?startPeriod=1995&endPeriod=1995",t).then((function(e){var t=e.data.structure.dimensions.series.filter((function(e){return"REF_AREA"===e.id}))[0].values;n.setState({countries:t}),console.log("Got countries")})).catch((function(e){console.error(e),document.querySelector("#loader-main").style.opacity=0,document.querySelector("#error").style.display="block",document.querySelector("#error").style.opacity=1}));case 4:return e.next=6,b.a.get(a,t).then((function(e){var t=e.data.structure.dimensions.observation[0].values;n.setState({years:t})}));case 6:document.querySelector("#loader-main").style.opacity=0,setTimeout((function(){document.querySelector("#loader-main").style.display="none"}),500),r=document.querySelector("footer").offsetHeight+5+"px",document.querySelector(".modalDb").style.bottom=r,document.querySelector(".modalTech").style.bottom=r;case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"initGraph",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var a,r,n,o,s,l,i,u,d,m,p,y,h,f,v,w,T,S,x,Y,C,k,O,_,P,j,q,D,I,M,R,A,N,F,L,z,W,B,G,H,U,J=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),null!==this.state.selectedCountry&&""!==this.state.yearStart&&""!==this.state.yearEnd){e.next=9;break}(a=document.querySelectorAll(".input-number"))[0].style.border="2px solid #ff0000",a[1].style.border="2px solid #ff0000",null===this.state.selectedCountry&&(document.querySelector("#input-text").style.border="2px solid #ff0000"),setTimeout((function(){document.querySelector("#input-text").style.border="2px solid transparent",a[0].style.border="2px solid transparent",a[1].style.border="2px solid transparent"}),300),e.next=72;break;case 9:if(r=parseInt(this.state.years[0].name),n=parseInt(this.state.years[this.state.years.length-1].name),!(parseInt(this.state.yearStart)<r||parseInt(this.state.yearStart)>n||parseInt(this.state.yearEnd)<r||parseInt(this.state.yearEnd)>n)){e.next=19;break}o=document.querySelectorAll(".input-number"),document.querySelector(".years-minmax").style.color="red",o[0].style.border="2px solid #ff0000",o[1].style.border="2px solid #ff0000",setTimeout((function(){o[0].style.border="2px solid transparent",o[1].style.border="2px solid transparent",document.querySelector(".years-minmax").style.color="black"}),600),e.next=72;break;case 19:for(document.querySelector("#loader-form").style.opacity=1,s=new g.k,l=new g.e;s.children.length>0;)s.remove(s.children[0]);for(;l.children.length>0;)l.remove(l.children[0]);for(s.dispose(),s.background=new g.c(16777215),i=new g.i(75,window.innerWidth/window.innerHeight,.1,1e3),(u=new g.q({antialias:!0})).setSize(window.innerWidth,window.innerHeight),document.body.appendChild(u.domElement),i.position.z=5,d={headers:{Accept:"text/json"}},m=[],p=[],y=0;y<21;y++)p[y]=[],m[y]=[];return h=.05*(parseInt(this.state.yearEnd)-parseInt(this.state.yearStart))+.05,f=new g.b(.03,2.1,h),v=new g.h({color:1052688}),w=new g.g(f,v),s.add(w),T=function(e,t,a){for(var r=0;r<parseInt(J.state.yearEnd)-(parseInt(J.state.yearStart)-1);r++){var n=t[Object.keys(t)[r]][0];"M"===e?p[a][r]=n:m[a][r]=n}},S="https://cors-anywhere.herokuapp.com/https://data.un.org/ws/rest/data/DF_UNData_WPP/SP_POP_TOTL.A.Y_LT5+Y5T10+Y10T14+Y15T19+Y20T24+Y25T29+Y30T34+Y35T39+Y40T44+Y45T49+Y50T54+Y55T59+Y60T64+Y65T69+Y70T74+Y75T79+Y80T84+Y85T89+Y90T94+Y95T99+Y_GE100.M._T.".concat(this.state.selectedCountryId,".M?startPeriod=").concat(this.state.yearStart,"&endPeriod=").concat(this.state.yearEnd),e.next=42,b.a.get(S,d).then((function(e){for(var t=e.data.dataSets[0].series,a=0;a<21;a++){var r=t[Object.keys(t)[a]].observations;T("M",r,0===a?20:1===a?0:12===a?1:a<=11?a:a-1)}})).catch((function(e){console.error(e),document.querySelector("#error").style.display="block",document.querySelector("#error").style.opacity=1}));case 42:return S="https://cors-anywhere.herokuapp.com/https://data.un.org/ws/rest/data/DF_UNData_WPP/SP_POP_TOTL.A.Y_LT5+Y5T10+Y10T14+Y15T19+Y20T24+Y25T29+Y30T34+Y35T39+Y40T44+Y45T49+Y50T54+Y55T59+Y60T64+Y65T69+Y70T74+Y75T79+Y80T84+Y85T89+Y90T94+Y95T99+Y_GE100.F._T.".concat(this.state.selectedCountryId,".M?startPeriod=").concat(this.state.yearStart,"&endPeriod=").concat(this.state.yearEnd),e.next=45,b.a.get(S,d).then((function(e){for(var t=e.data.dataSets[0].series,a=0;a<21;a++){var r=t[Object.keys(t)[a]].observations;T("F",r,0===a?20:1===a?0:12===a?1:a<=11?a:a-1)}})).catch((function(e){document.querySelector("#error").style.display="block",document.querySelector("#error").style.opacity=1,console.error(e)}));case 45:for(x=p.map((function(e){return Math.max.apply(Math,e)})),Y=Math.max.apply(null,x),C=p.map((function(e){return Math.max.apply(Math,e)})),k=Math.max.apply(null,C),O=Math.max(Y,k),_=new g.h({map:(new g.n).load("texture_short.png")}),P=new g.h({map:(new g.n).load("texture_long.png")}),j=new g.h({map:(new g.n).load("texture_med.png")}),q=new g.h({map:(new g.n).load("texture_med_low.png")}),D=0;D<p.length;D++)for(I=0;I<p[D].length;I++)M=p[D][I]/O*3,R=new g.b(M,.1,.05),A=void 0,A=M>2?[_,_,P,P,P,P]:M>1?[_,_,j,j,j,j]:M>.1?[_,_,q,q,q,q]:[_,_,_,_,_,_],N=new g.g(R,A),l.add(N),N.position.set(M/-2-.016,.1*D-1,0+-.05*I);for(F=0;F<m.length;F++)for(L=0;L<m[F].length;L++)z=m[F][L]/O*3,W=new g.b(z,.1,.05),B=void 0,B=z>2?[_,_,P,P,P,P]:z>1?[_,_,j,j,j,j]:z>.1?[_,_,q,q,q,q]:[_,_,_,_,_,_],G=new g.g(W,B),l.add(G),G.position.set(z/2+.015,.1*F-1,0+-.05*L);H=(new g.a).setFromObject(l),console.log(),s.add(l),l.position.set(0,0,H.getSize().z/2-.025),(U=new E.a(i,u.domElement)).rotateSpeed=.5,U.zoomSpeed=1.2,U.panSpeed=.8,U.maxDistance=10,U.minDistance=4,U.enableDamping=!0,function e(){requestAnimationFrame(e),U.update(),u.render(s,i)}(),window.addEventListener("resize",(function(){i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight)}),!1),document.querySelector("#reset").addEventListener("click",(function(){U.reset()})),setTimeout((function(){document.querySelector("form").style.opacity=0,setTimeout((function(){document.querySelector("form").style.display="none"}),500)}),500);case 72:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"App"},n.a.createElement("div",{id:"error"},n.a.createElement("p",null,"An error ocurred."),n.a.createElement("button",{onClick:function(){window.location.reload()}},"Reload")),n.a.createElement("div",{id:"loader-main"},n.a.createElement(x,{id:"loader-gif"})),n.a.createElement("h1",null,"Age pyramid visualizer"),n.a.createElement("form",null,n.a.createElement("div",{className:"form-wrapper"},n.a.createElement("p",null,"1. Select Country"),n.a.createElement("div",{className:"cnt-input-wrapper"},n.a.createElement(_,{id:"search"}),n.a.createElement("input",{id:"input-text",type:"text",name:"country",value:this.state.countryInput,onChange:this.searchCountry,autoFocus:!0,autoComplete:"off",required:!0}),n.a.createElement("ul",{className:"cnt-list",style:{opacity:0!==this.state.matchedCountries.length?1:0}},this.state.matchedCountries.map((function(t){return n.a.createElement("li",{className:"cnt-list__li ".concat(e.state.selectedCountry===t.name?"cnt-list__li-active":""),key:t.id,onClick:function(){e.setState({selectedCountryId:t.id,selectedCountry:t.name,countryInput:t.name,matchedCountries:[]}),document.querySelector(".cnt-list").style.opacity=0}},t.name)})))),n.a.createElement("p",{style:{opacity:null!==this.state.selectedCountryId?1:0}},"2. Specify start and end years"),n.a.createElement("div",{className:"years-wrapper",style:{opacity:null!==this.state.selectedCountryId?1:0}},n.a.createElement("input",{type:"number",name:"yearStart",value:this.state.yearStart,onChange:this.handleYearChange,autoComplete:"off",required:!0,className:"input-number"}),n.a.createElement("p",null,"-"),n.a.createElement("input",{type:"number",name:"yearEnd",value:this.state.yearEnd,onChange:this.handleYearChange,autoComplete:"off",required:!0,className:"input-number"}),n.a.createElement("p",{className:"years-minmax"},"min: ",this.state.years[0].name," - max:"," ",this.state.years[this.state.years.length-1].name)),n.a.createElement("button",{onClick:this.initGraph.bind(this),style:{opacity:""!==this.state.yearStart&&""!==this.state.yearEnd?1:0}},"Submit"),n.a.createElement(x,{id:"loader-form"}))),n.a.createElement("footer",null,n.a.createElement("p",null,"Current Country: ",n.a.createElement("b",null,this.state.selectedCountry),n.a.createElement("br",null),"Current Years:"," ",n.a.createElement("b",null,this.state.yearStart," - ",this.state.yearEnd),n.a.createElement("br",null),n.a.createElement("span",{id:"reset"},n.a.createElement("b",null,"Reset view"))),n.a.createElement("hr",null),n.a.createElement("p",null,"Created by"," ",n.a.createElement("a",{href:"https://github.com/Tasztalos69",style:{color:"black"}},"BMK.")," ",n.a.createElement("br",null)," Licensed under ",n.a.createElement("b",null,"MIT")," License. ",n.a.createElement("br",null)," ",n.a.createElement("u",{onClick:function(){e.setState({modalDb:!e.state.modalDb,modalTech:!1})}},"Database"),"|",n.a.createElement("u",{onClick:function(){e.setState({modalTech:!e.state.modalTech,modalDb:!1})}},"Technology"))),n.a.createElement("div",{className:"modals modalDb",style:{opacity:this.state.modalDb?1:0}},n.a.createElement("p",null,"Database used:"," ",n.a.createElement("a",{href:"https://data.un.org"},"https://data.un.org"))),n.a.createElement("div",{className:"modals modalTech",style:{opacity:this.state.modalTech?1:0}},n.a.createElement("h3",null,"Technology used:"),n.a.createElement("ul",null,n.a.createElement("li",null,"Framework: ",n.a.createElement("a",{href:"https://reactjs.org"},"React")),n.a.createElement("li",null,"Renderer: ",n.a.createElement("a",{href:"https://threejs.org"},"Three js")),n.a.createElement("li",null,"Requests: ",n.a.createElement("a",{href:"https://github.com/axios/axios"},"Axios")))))}}]),t}(n.a.Component));s.a.render(n.a.createElement(P,null),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.d681a7ac.chunk.js.map